var h=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var f=Object.prototype.hasOwnProperty;var b=(o,e)=>{for(var u in e)h(o,u,{get:e[u],enumerable:!0})},I=(o,e,u,g)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of m(e))!f.call(o,n)&&n!==u&&h(o,n,{get:()=>e[n],enumerable:!(g=p(e,n))||g.enumerable});return o};var U=o=>I(h({},"__esModule",{value:!0}),o);var _={};b(_,{default:()=>d});module.exports=U(_);var c=require("enmity/api/plugins"),s=require("enmity/metro"),l=require("enmity/metro/stores"),d=class extends c.Plugin{settings={targetId:""};patchIds=[];start(){this.settings=c.Settings.load(this.name)||this.settings,this.patchMessages(),this.patchProfileUI()}stop(){this.patchIds.forEach(e=>s.Patcher.unpatchAll(e))}getTargetUser(){return l.UserStore.getUser(this.settings.targetId)}patchMessages(){let e="LocalImpersonator-Messages";this.patchIds.push(e),s.Patcher.after(e,"Messages","renderMessage",(u,g)=>{let n=u[0].message,a=this.getTargetUser();return n.author.id===l.UserStore.getCurrentUser().id&&a&&(n.author.username=a.username,n.author.global_name=a.global_name||a.username,n.author.avatar=a.avatar),g})}patchProfileUI(){let e="LocalImpersonator-ProfileUI";this.patchIds.push(e);let u=s.Webpack.getModule(a=>a.default&&a.default.displayName==="UserPopout"),g=s.Webpack.getModule(a=>a.default&&a.default.displayName==="SidebarUserItem"),n=s.Webpack.getModule(a=>a.default&&a.default.displayName==="UserProfileModal");s.Patcher.after(e,u,"default",(a,i)=>{let t=this.getTargetUser();if(!t)return i;let r=a[0];return r.user.id===l.UserStore.getCurrentUser().id&&(r.user.username=t.username,r.user.global_name=t.global_name||t.username,r.user.avatar=t.avatar,r.user.banner=t.banner,r.user.accent_color=t.accent_color),i}),s.Patcher.after(e,g,"default",(a,i)=>{let t=this.getTargetUser();if(!t)return i;let r=a[0];return r.user.id===l.UserStore.getCurrentUser().id&&(r.user.username=t.username,r.user.global_name=t.global_name||t.username,r.user.avatar=t.avatar,r.user.banner=t.banner,r.user.accent_color=t.accent_color),i}),s.Patcher.after(e,n,"default",(a,i)=>{let t=this.getTargetUser();if(!t)return i;let r=a[0];return r.user.id===l.UserStore.getCurrentUser().id&&(r.user.username=t.username,r.user.global_name=t.global_name||t.username,r.user.avatar=t.avatar,r.user.banner=t.banner,r.user.accent_color=t.accent_color),i})}onSettingsSave(e){this.settings=e,c.Settings.save(this.name,this.settings)}getSettingsPanel(){return s.React.createElement("div",{},s.React.createElement("input",{type:"text",placeholder:"Target Discord ID",value:this.settings.targetId,onChange:e=>{this.settings.targetId=e.target.value}}))}};
